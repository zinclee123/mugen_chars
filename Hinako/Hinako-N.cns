;=====================================================================
;  CNS File For "Hinako"                           
;=====================================================================

;---------------------------------------------------------------------
; 変数表
;	Var(1)	: 各種ヒット判定
;	Var(2)	: 派生入力フラグ
;	Var(3)	: 総合ヒット数カウンタ
;	Var(4)	: ガードキャンセルフラグ
;	Var(26)	: 大ジャンプフラグ
;	Var(27) : 大ジャンプ中のレバー入力管理
;	Var(28) : 大ジャンプフラグ２
;	Var(29) : ＣＰＵ専用乱数
;	Var(30) : ＣＰＵ専用フラグ
;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 基本設定
[Data]
life = 1000          ; 体力ゲージ、上限値（デフォルト：1000）
attack = 100         ; 攻撃力（％）
defence = 100        ; 防御力（％）
power = 5000
fall.defence_up = 50 ; 空中コンボ修正率（％）
liedown.time = 40    ; ダウン時間
airjuggle = 8        ; 空中コンボ
sparkno = 2010      ; 初期ヒットスパーク番号
guard.sparkno = s2060 ; 初期ガードスパーク番号
KO.echo = 0          ; ＫＯボイスエコー（0:OFF、1:ON）
volume = -5          ; キャラボイスボリューム値

[Size]
xscale = 1           ; 水平サイズ倍率
yscale = 1           ; 垂直サイズ倍率
ground.back = 18     ; キャラ幅（地上、後ろ側）
ground.front = 18    ; キャラ幅（地上、前側）
air.back = 13        ; キャラ幅（空中、後ろ側）
air.front = 13       ; キャラ幅（空中、前側）
z.width = 10         ; キャラ幅（ｚ軸）
height = 60	     ; キャラの高さ（ジャンプで飛び越せる高さ）
attack.width = 4,4   ;Default attack width: back, front
attack.dist = 160    ;Default attack distance
proj.attack.dist = 90;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too   
head.pos = 12,-73    ; 頭部座標
mid.pos = -2,-51     ; 体中心部座標
shadowoffset = 2     ; キャラの影・オフセット値

[Velocity]
walk.fwd  = 2.68         ; 前進速度
walk.back = -2.30        ; 後退速度
run.fwd  = 6.21, 0       ; 前ダッシュ速度（y<0の場合、ホップステップ）
run.back = -4.28,-4.44   ; バックステップ速度（y=0の場合、走り）
jump.neu = 0,-9.74       ; 垂直ジャンプ速度
jump.back = -2.10        ; 後方ジャンプ速度
jump.fwd = 2.30          ; 前方ジャンプ速度
runjump.back = -3.60,-9.74 ; 後方ジャンプ速度（ダッシュ中）
runjump.fwd = 3.80,-9.74  ; 前方ジャンプ速度（ダッシュ中）
;airjump.neu = 0,-9.3      ; 空中垂直ジャンプ速度
;airjump.back = -2.55,-8.1 ; 空中後方ジャンプ速度
;airjump.fwd = 2.5,-8.1    ; 空中前方ジャンプ速度

[Movement]
airjump.num = 0       ; 空中ジャンプ回数
;airjump.height = 35  ; 空中ジャンプ最低高度
yaccel = .50          ; キャラ重力加速度
stand.friction = .85  ; 摩擦係数（立ち状態）
crouch.friction = .82 ; 摩擦係数（しゃがみ状態）

;===============================================================================
; Definition of the Basic Action
;===============================================================================

;-------------------------------------------------------------------------------
; ダッシュ
[Statedef 100]
type    = S
movetype = I
physics = N
anim = 100
ctrl = 0

[State 20]
type = changestate
trigger1 = var(59)
value = 1

[State 100,0]
type = VelSet
trigger1 = AnimElem = 2
x = Const(velocity.run.fwd.x)

[State 100,1]
type = PlaySnd
trigger1 = TimeMod = 70, 0
value = 100, 0

[State 100,2]
type = PlaySnd
trigger1 = TimeMod = 70, 21
value = 100, 1

[State 100,3]
type = PlaySnd
trigger1 = TimeMod = 70, 47
value = 100, 2

[State 100,3]
type = ChangeState
trigger1 = Command != "holdfwd"
value = 101
ctrl = 1

[State 100,ChangeState]
type = ChangeState
trigger1 = Command = "holdupfwd"
value = 40

[State 100,4]
type = AssertSpecial
trigger1 = 1
flag = NoWalk

;------------------------ 停止
[Statedef 101]
type = S
movetype = I
physics = S
anim = 101
velset = 0, 0

[State 101,End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------
; バックステップ
;------------------------ 開始
[Statedef 105]
type = S
movetype = I
physics = S
anim = 105
ctrl = 0
velset = 0, 0

[State 105,StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 2
statetype = A
physics = N

[State 105,VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = -4.8
y = -3.3

[State 105,Gravity]
type = Gravity
trigger1 = AnimElem = 2, > 0

[State 105,0]
type = PlaySnd
trigger1 = AnimElem = 2
value = 105, 0

[State 105,1]
type = ChangeState
trigger1 = AnimElem = 2, > 0
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 106

;------------------------ 着地
[Statedef 106]
type = S
movetype = I
physics = S
anim = 106
velset = 0, 0

[State 106,PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 106,2]
type = MakeDust
trigger1 = Time >= 0
pos = -30, 0

[State 106,3]
type = PlaySnd
trigger1 = Time = 0
value = 47, 0

[State 106,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================================
; Definition of the Win/Lose/Intro Pause
;===============================================================================

;-------------------------------------------------------------------------------
; 時間切れ負け
[Statedef 170]
type = S
ctrl = 0
anim = 175
velset = 0,0

[State 170,1]
type = NotHitBy
trigger1 = 1
value = SCA

;-------------------------------------------------------------------------------
; 時間切れ引き分け
[Statedef 175]
type = S
ctrl = 0
velset = 0,0

[State 175,0]
type = ChangeState
trigger1 = Time = 0
value = 170

;-------------------------------------------------------------------------------
; 勝利・分岐
[Statedef 180]
type = S
movetype = I
physics = S
velset = 0, 0
ctrl = 0

[State 180,0]
type = ChangeState
triggerall = Time = 0
trigger1 = Command = "hold_a"
value = 181

[State 180,0]
type = ChangeState
triggerall = Time = 0
trigger1 = Command = "hold_y"
value = 182

[State 180,ChangeState]
type = ChangeState
trigger1 = Time = 1
value = IfElse(Random > 499,181,182)

;-------------------------------------------------------------------------------
; 勝利１
[Statedef 181]
type = S
ctrl = 0
anim = 180
velset = 0,0

[State 181,1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 181,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 6
value = 180, 0

[State 181,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 10
value = 180, 1

[State 181,3]
type = AssertSpecial
trigger1 = Time = [0,200]
flag = RoundNotOver

;-------------------------------------------------------------------------------
; 勝利２
[Statedef 182]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 182,1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 182,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 4
value = 181, 0

[State 182,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 16
value = 181, 1

[State 182,3]
type = AssertSpecial
trigger1 = Time = [0,260]
flag = RoundNotOver

;-------------------------------------------------------------------------------
; イントロ１
[Statedef 191]
type = S
movetype = I
physics = S
anim = 191
velset = 0, 0
ctrl = 0

[State 191,ChangeState]
type = ChangeState
triggerall = Time = 0
trigger1 = P2Name = "Yuri Sakazaki" || P4Name = "Yuri Sakazaki"
trigger2 = P2Name = "Mai Shiranui" || P4Name = "Mai Shiranui"
trigger3 = P2Name = "Kasumi Todo" || P4Name = "Kasumi Todo"
trigger4 = P2Name = "Hinako Shijo" || P4Name = "Hinako Shijo"
trigger5 = P2Name = "Yuri98" || P4Name = "Yuri98"
trigger6 = P2Name = "Mai" || P4Name = "Mai"
trigger7 = P2Name = "E.Honda" || P4Name = "E.Honda"
value = 192

[State 191,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 12
value = 191, 0

[State 191,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 24
value = 191, 1

[State 191,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 24
value = 900, 3

[State 191,Explod]
type = Explod
trigger1 = AnimElem = 24
anim = 2310
pos = -10, 0
postype = P1
sprpriority = 0
bindtime = 1
ownpal = 1

[State 191,4]
type = AssertSpecial
trigger1 = Time = [0,280]
flag = Intro

[State 191,5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;-------------------------------------------------------------------------------
; イントロ２
[Statedef 192]
type = S
movetype = I
physics = S
anim = 192
velset = 0, 0
ctrl = 0

[State 192,PlaySnd]
type = PlaySnd
trigger1 = Time = 52
value = 192, 0

[State 192,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5
value = 192, 1

[State 192,Explod]
type = Explod
trigger1 = AnimElem = 5
anim = 193
pos = 0, 0
postype = P1
sprpriority = 2
bindtime = 1
ownpal = 1

[State 192,4]
type = AssertSpecial
trigger1 = Time = [0,200]
flag = Intro

[State 192,5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;-------------------------------------------------------------------------------
; 挑発
[Statedef 195]
type = S
movetype = I
physics = S
anim = 195
velset = 0, 0
ctrl = 0

[State 195,PlaySnd]
type = PlaySnd
trigger1 = Time = 0
value = 195, 0

[State 195,2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================================
; Definition of the Basic Arts
;===============================================================================

;-------------------------------------------------------------------------------
; 立ち弱パンチ
[Statedef 200]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 0,0
ctrl = 0
anim = 200
poweradd = 0

[State 200,3]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA
animtype = Light
damage    = 40*fvar(39)
getpower = 50
givepower = 15
guardflag = M
hitflag = MAF
priority = 3, Hit
pausetime = 9,10
numhits = 1
sparkno = S2000
guard.sparkno = s2050
sparkxy = -10,-75
hitsound = S300, 0
guardsound = S0, 0
ground.type = High
ground.slidetime = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 10*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3.5
ground.cornerpush.veloff = -5
air.velocity = -2,-2

[State 200,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 立ち強パンチ
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 3
poweradd= 0
ctrl = 0
velset = 0,0
anim = 210

[State 220,3]
type = HitDef
trigger1 = AnimElem = 6
attr = S, NA
animtype  = Heavy
damage    = 70*fvar(39)
getpower = 100
givepower = 30
guardflag = M
pausetime = 9,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-78
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -4
ground.cornerpush.veloff = -13
guard.hittime = 22
guard.ctriltime = 22
air.velocity = -5.2,-3.2

[State 220,5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 立ち弱キック
[Statedef 220]
type    = S
movetype= A
physics = S
juggle  = 2
poweradd= 0
ctrl = 0
velset = 0,0
anim = 220

[State 210,3]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA
animtype  = Light
damage    = 40*fvar(39)
getpower = 50
givepower = 15
guardflag = M
pausetime = 8,10
numhit = 1
sparkno = S2000
guard.sparkno = s2050
sparkxy = -15,-69
hitsound = S300, 1
guardsound = S0, 0
ground.type = Low
ground.slidetime = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -5.5
guard.ctrltime = 12
air.velocity = -2,-2
ground.cornerpush.veloff = -8.5
air.cornerpush.veloff = -5.0

[State 210,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 22

[State 210,PosAdd]
type = PosAdd
trigger1 = AnimElem = 3
x = 15

[State 210,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 立ち強キック
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 3
poweradd= 0
ctrl = 0
velset = 0,0
anim = 230

[State 230,3]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA
animtype  = Heavy
damage    = 70*fvar(39)
getpower = 100
givepower = 30
guardflag = L
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-21
hitsound = S300, 3
guardsound = S0, 0
ground.type = Low
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
air.velocity = -5.2,-3.2

[State 230,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; しゃがみ弱パンチ
[Statedef 300]
type    = C
movetype= A
physics = C
juggle  = 2
poweradd= 0
ctrl = 0
anim = 300

[State 300,3]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
animtype  = Light
damage    = 40*fvar(39)
getpower  = 40
givepower = 15
hitflag = MAF
guardflag = M
pausetime = 8,10
sparkno = S2000
guard.sparkno = s2050
sparkxy = -15,-49
hitsound = S300, 0
guardsound = S0, 0
ground.type = Low
ground.slidetime = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
guard.hittime = 10
guard.ctriltime = 10
air.velocity = -2,-2


[State 300,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;-------------------------------------------------------------------------------
; しゃがみ強パンチ
[Statedef 310]
type    = C
movetype= A
physics = C
juggle  = 3
poweradd= 0
ctrl = 0
anim = 310

[State 320,3]
type = HitDef
trigger1 = AnimElem = 8
attr = C, NA
animtype  = Heavy
damage    = 40*fvar(39)
getpower  = 100
givepower = 30
hitflag = MAF
guardflag = M
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-59
hitsound = S300, 2
guardsound = S0, 0
ground.type = Low
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -2
guard.hittime = 20
guard.ctriltime = 20
air.velocity = -5.2,-4.2



[State 320,3]
type = HitDef
trigger1 = AnimElem = 10
attr = C, NA
animtype  = Heavy
damage    = 60*fvar(39)
getpower  = 180
givepower = 45
hitflag = MAF
guardflag = M
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-85
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
guard.hittime = 20
guard.ctriltime = 20
air.velocity = -7,-4.2


[State 310,PosAdd]
type = PosAdd
trigger1 = AnimElem = 8
x = 18

[State 310,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2 || AnimElem = 14
x = 15

[State 320,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;-------------------------------------------------------------------------------
; しゃがみ弱キック
[Statedef 320]
type    = C
movetype= A
physics = C
juggle  = 2
poweradd= 0
ctrl = 0
anim = 320
velset = 0, 0

[State 310,3]
type = HitDef
trigger1 = AnimElem = 3
attr = C, NA
animtype = Light
damage    = 40*fvar(39)
getpower  = 50
givepower = 15
hitflag = MAF
guardflag = L
pausetime = 10,10
sparkno = S2000
guard.sparkno = s2050
sparkxy = -15,-6
hitsound = S300, 1
guardsound = S0, 0
ground.type = Low
ground.slidetime = 10*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 10*(1+ifelse(var(9)>0, 0.2, 0))
guard.hittime = 10
guard.ctriltime = 10
ground.velocity = -3
ground.cornerpush.veloff = -3.5
air.velocity = -4.3,-3




[State 310,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;-------------------------------------------------------------------------------
; しゃがみ強キック
[Statedef 330]
type    = C
movetype= A
physics = C
juggle  = 8
poweradd= 0
ctrl = 0
anim = 330

[State 330,3]
type = HitDef
trigger1 = AnimElem = 5
attr = C, NA
animtype = Hard
damage    = 70*fvar(39)
getpower  = 100
givepower = 30
hitflag = MAF
guardflag = L
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-19
hitsound = S300, 3
guardsound = S0, 0
ground.type = Trip
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
guard.hittime = 20
guard.ctrltime = 20
ground.velocity = -3.2,-2
air.velocity = -4.0,-3
guard.velocity = -5
fall = 1
id = 330

[State 330,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;-------------------------------------------------------------------------------
; ジャンプ弱パンチ
[Statedef 500]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 0
ctrl = 0
anim = 500

[State 500]
type = Width
trigger1 = 1
edge = 2,0

[State 500,3]
type = HitDef
trigger1 = AnimElem = 2
attr = A, NA
damage    = 40*fvar(39)
getpower  = 50
givepower = 15
guardflag = H
priority = 3,Hit
pausetime = 10,10
sparkno = S2000
guard.sparkno = s2050
sparkxy = -15,-59
hitsound = S300, 0
guardsound = S0, 0
ground.type = High
ground.slidetime = 9*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 9*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
air.velocity = -4.3,-3

;-------------------------------------------------------------------------------
; ジャンプ強パンチ
[Statedef 510]
type    = A
movetype= A
physics = A
juggle  = 3
poweradd= 0
ctrl = 0
anim = 510

[State 510]
type = Width
trigger1 = 1
edge = 2,0

[State 520,3]
type = HitDef
trigger1 = AnimElem = 3
attr = A, NA
animtype = Hard
damage    = 70*fvar(39)
getpower  = 100
givepower = 30
guardflag = H
priority = 6,Hit
pausetime = 10,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-34
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 17*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 17*(1+ifelse(var(9)>0, 0.2, 0))
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -3.5
air.velocity = -5.2,-3.2

;-------------------------------------------------------------------------------
; ジャンプ弱キック
[Statedef 520]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 0
ctrl = 0
anim = 520

[State 520]
type = Width
trigger1 = 1
edge = 2,0

[State 510,3]
type = HitDef
trigger1 = AnimElem = 2
attr = A, NA
damage    = 40*fvar(39)
getpower  = 100
givepower = 30
guardflag = H
priority = 3,Hit
pausetime = 10,10
sparkno = S2000
guard.sparkno = s2050
sparkxy = -10,-48
hitsound = S300, 1
guardsound = S0, 0
ground.type = High
ground.slidetime = 9*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 9*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
air.velocity = -4.3,-3

;-------------------------------------------------------------------------------
; ジャンプ強キック
[Statedef 530]
type    = A
movetype= A
physics = A
juggle  = 3
poweradd= 0
ctrl = 0
anim = 530

[State 645]
type = Width
trigger1 = 1
edge = 2,0

[State 530,3]
type = HitDef
trigger1 = AnimElem = 2
attr = A, NA
animtype = Hard
damage    = 40*fvar(39)
getpower  = 100
givepower = 30
guardflag = H
priority = 6,Hit
pausetime = 10,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-48
hitsound = S300, 3
guardsound = S0, 0
ground.type = High
ground.slidetime = 17*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 17*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3.5
guard.hittime = 17
guard.ctriltime = 17
air.velocity = -5.2,-3.2

[State 530,3]
type = HitDef
trigger1 = AnimElem = 5
attr = A, NA
animtype = Hard
damage    = 40*fvar(39)
getpower  = 100
givepower = 30
guardflag = H
priority = 3
pausetime = 10,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-50
hitsound = S300, 3
guardsound = S0, 0
ground.type = High
ground.slidetime = 17*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 17*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3.5
guard.hittime = 17
guard.ctriltime = 17
air.velocity = -5.2,-3.2

;-------------------------------------------------------------------------------
; 地上ふっとばし攻撃
[Statedef 600]
type = S
movetype = A
physics = S
juggle = 5
poweradd= 0
anim = 600
ctrl = 0

[State 600,6]
type = Hitdef
trigger1 = AnimElem = 9
attr = S, NA
animtype = Hard
damage    = 120*fvar(39)
getpower = 125
givepower = 40
guardflag = M
hitflag = MAF
pausetime = 12,14
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-44
hitsound = S300, 4
guardsound = S0, 0
ground.type = High
ground.slidetime = 15*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 15*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 15
ground.velocity = -2,-3.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = -7
air.velocity = -4.2,-3.5
fall = 1
fall.recover = 0
air.recover = 0
recover = 0

[State 600,VelSet]
type = VelSet
trigger1 = AnimElem = 9
x = 3.0

[State 600,PosAdd]
type = PosAdd
trigger1 = AnimElem = 4
x = 20

[State 600,PosAdd]
type = PosAdd
trigger1 = AnimElem = 14
x = 14

[State 600,PosAdd]
type = PosAdd
trigger1 = AnimElem = 15
x = 5

[State 600,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 8
value = 200, 2

[State 600,7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 空中ふっとばし攻撃
[Statedef 610]
type = A
movetype = A
physics = A
ctrl = 0
anim = 610
poweradd= 0

[State 610]
type = Width
trigger1 = 1
edge = 2,0

[State 610,3]
type = Hitdef
trigger1 = !var(9)
trigger1 = AnimElem = 4
attr = A, NA
animtype = Hard
damage    = 120*fvar(39)
getpower = 125
givepower = 40
guardflag = H
priority = 6,Hit
hitflag = MAF
pausetime = 12,14
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-45
hitsound = S300, 4
guardsound = S0, 0
ground.type = High
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
guard.hittime = 20
guard.ctriltime = 20
ground.velocity = -4,-3.5
air.velocity = -4.2,-3.5
fall = 1
fall.recover = 0
air.recover = 0
recover = 0
id = 610

[State 610,3]
type = Hitdef
trigger1 = var(9)
trigger1 = AnimElem = 4
attr = A, NA
animtype = Hard
damage    = 120*fvar(39)
getpower = 125
givepower = 40
guardflag = M
hitflag = MAF
pausetime = 12,14
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-45
hitsound = S300, 4
guardsound = S0, 0
ground.type = High
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -0.5, -7.5
air.velocity = -4.2,-3.5
fall = 1
fall.recover = 0
air.recover = 0
recover = 0
id = ifelse(EnemyNear,StateType !=A, 611, 622)

;===============================================================================
; Definition of the (Dir + Button) attack
;===============================================================================

;-------------------------------------------------------------------------------
; 張り手（→＋Ｘ）
[Statedef 700]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 700
poweradd = 0

[State 700,VarSet]
type = VarSet
trigger1 = Time = 0
v = 2
value = 0

[State 700,VarSet]
type = VarSet
trigger1 = (AnimElemNo(0) = [6,10]) && Command = "x" && Var(2) = 0
v = 2
value = 1

[State 700,VarSet]
type = VarSet
trigger1 = (AnimElemNo(0) = [6,10]) && Command = "y" && Var(2) = 0
v = 2
value = 2

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 3 || AnimElem = 11
x = 20

[State 700,1]
type = PosAdd
trigger1 = AnimElem = 9
x = 15

[State 700,3]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype = Hard
damage    = 55*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 9,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-79
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 23*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 23*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 23
ground.velocity = -3
air.velocity = -5.0,-3.5

[State 700,ChangeState]
type = ChangeState
trigger1 = AnimElem = 11 && !Var(2) = 0
value = IfElse(Var(2) = 1,710,720)

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 張り手・千代（張り手後、＋Ｘ）
[Statedef 710]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 710
poweradd = 0

[State 700,3]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype = Hard
damage    = 55*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 10,10
sparkno = S2000
guard.sparkno = s2050
sparkxy = -15,-75
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 18*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 18*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 18
ground.velocity = -4
air.velocity = -5.0,-3.5

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 張り手・錦（張り手後、＋Ｙ）
[Statedef 720]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 720
poweradd = 0

[State 720,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 20

[State 700,3]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype = Hard
damage    = 65*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 9,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-78
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 18*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 18*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 18
ground.velocity = -4
air.velocity = -5.0,-3.5

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; まえみつ叩き（３＋Ｘ）
[Statedef 730]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 730
poweradd = 0

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 3
x = 20

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 5
x = 15

[State 700,3]
type = HitDef
trigger1 = AnimElem = 6
attr = S, NA
animtype = Hard
damage    = 30*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 8,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-35
hitsound = S300, 2
guardsound = S0, 0
ground.type = Low
ground.slidetime = 22*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 22*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 22
ground.velocity = -1.5
ground.cornerpush.veloff = -5
air.velocity = -5.0,-3.5

[State 700,3]
type = HitDef
trigger1 = AnimElem = 7
attr = S, NA
animtype = Hard
damage    = 30*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 8,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-59
hitsound = S300, 2
guardsound = S0, 0
ground.type = Low
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 20
ground.velocity = -5.0
ground.cornerpush.veloff = -5
air.velocity = -5.0,-3.5

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 突っ張り（→＋Ａ）
[Statedef 740]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 740
poweradd = 0

[State 700,VarSet]
type = VarSet
trigger1 = Time = 0
v = 2
value = 0

[State 700,VarSet]
type = VarSet
trigger1 = (AnimElemNo(0) = [3,6]) && Command = "a" && Var(2) = 0
v = 2
value = 1

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 2 || AnimElem = 4 || (AnimElem = 7  && Var(2) = 0)
x = 20

[State 700,1]
type = PosAdd
trigger1 = AnimElem = 8
x = 3

[State 700,3]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype = Hard
damage    = 50*fvar(39)
getpower = 80
givepower = 25
guardflag = M
hitflag = MAF
pausetime = 9,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-59
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 22*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 22*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -3
guard.ctrltime = 22
guard.velocity = -5.0
air.velocity = -5.0,-3.5
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6.0
id = 740

[State 700,ChangeState]
type = ChangeState
trigger1 = AnimElem = 7 && Var(2) = 1
value = 750

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 突っ張り・追加入力（突っ張り後、＋Ａ）
[Statedef 750]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 750
poweradd = 0

[State 750,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2 || AnimElem = 3
x = 20

[State 750,PosAdd]
type = PosAdd
trigger1 = AnimElem = 4
x = 6

[State 700,3]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA
animtype = Hard
damage    = 50*fvar(39)
getpower = 80
givepower = 25
guardflag = H
hitflag = MAF
pausetime = 9,10
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-69
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 18*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 18*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 18
ground.velocity = -2.0
guard.velocity = -12.0
air.velocity = -5.0,-3.5
ground.cornerpush.veloff = -6.0
air.cornerpush.veloff = -5.0

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 喉輪（３＋Ｙ）
[Statedef 760]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 760
poweradd = 0

[State 700,VarSet]
type = VarSet
trigger1 = Time = 0
v = 2
value = 0

[State 700,VarSet]
type = VarSet
trigger1 = (AnimElemNo(0) = [4,9]) && Command = "b" && Var(2) = 0
v = 2
value = 1

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 3 || AnimElem = 4
x = 20

[State 700,1]
type = PosAdd
trigger1 = AnimElem = 10 && Var(2) = 0
x = 15

[State 760,PosAdd]
type = PosAdd
trigger1 = AnimElem = 11
x = 8

[State 700,3]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA
animtype = Hard
damage    = 50*fvar(39)
getpower = 80
givepower = 25
guardflag = M
priority = 8,Hit
hitflag = MAF
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-72
hitsound = S300, 2
guardsound = S0, 0
ground.type = High
ground.slidetime = 20*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 20*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 20
ground.velocity = -2.0
air.velocity = -0.5, -9.0
air.fall = 1
fall.recover = 0
id = 760


[State 700,ChangeState]
type = ChangeState
Trigger1 = var(59) = 0
trigger1 = AnimElem = 10 && Var(2) = 1
value = 770

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 喉輪・追加入力（喉輪後、＋Ｂ）
[Statedef 770]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 770
poweradd = 0

[State 750,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 20

[State 750,PosAdd]
type = PosAdd
trigger1 = AnimElem = 3
x = 16

[State 700,3]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA
animtype = Hard
damage    = 50*fvar(39)
getpower = 80
givepower = 25
guardflag = H
hitflag = MAF
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-21
hitsound = S300, 3
guardsound = S0, 0
ground.type = Trip
ground.slidetime = 19*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 19*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 19
ground.velocity = -1.6,-2
air.velocity = -4.0,-3
guard.velocity = -5
p2stateno = 5000
fall = 1
id = 770

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; けたぐり（３＋Ｂ）
[Statedef 780]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 780
poweradd = 0

[State 700,0]
type = PosAdd
trigger1 = AnimElem = 7
x = 15

[State 700,1]
type = PosAdd
trigger1 = AnimElem = 9
x = 20

[State 760,PosAdd]
type = PosAdd
trigger1 = AnimElem = 10 || AnimElem = 11
x = 10

[State 700,1]
type = PosAdd
trigger1 = AnimTime = 0
x = 18

[State 700,3]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA
animtype = Hard
damage    = 60*fvar(39)
getpower = 80
givepower = 25
guardflag = L
hitflag = MAF
pausetime = 12,12
sparkno = s2010
guard.sparkno = s2060
sparkxy = -15,-19
hitsound = S300, 3
guardsound = S0, 0
ground.type = Low
ground.slidetime = 15*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 15*(1+ifelse(var(9)>0, 0.2, 0))
guard.ctrltime = 15
ground.velocity = -5
air.velocity = -5.2,-3.2

[State 700,4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================================
; Definition of the Basic Throws
;===============================================================================

;-------------------------------------------------------------------------------
; 襷投げ（Ｐ通常投げ）
[Statedef 900]
type = S
movetype = A
physics = S
ctrl = 0
anim = 900
velset = 0, 0

[State 900]
type = NotHitBy
trigger1 = 1
value = SCA

[State 900,1]
type = Hitdef
trigger1 = Time = 0
trigger1 = P2MoveType != H
trigger1 = P2StateNo != [150,155]
attr = S, NT
priority = 8,Miss
getpower = 0
givepower = 0
hitflag = M-
numhits = 0
sparkno = -1
p1facing = 1
p2facing = 1
p1stateno = 910
p2stateno = 920
p2getp1state = 1
hitsound = S900, 0
fall = 1
fall.recover = 0

[State 900,2]
type = ChangeState
trigger1 = AnimTime = 0
value = 210

;-------------------------------------------------------------------------------
; 襷投げ（成功）
[Statedef 910]
type = S
movetype = A
physics = S
anim = 910
velset = 0, 0
poweradd = 0

[State 810, ????]
type = ChangeState
triggerall =!(Teammode = simul)
Trigger1 = AnimElemtime(2) = 14
trigger1 = numtarget && target,stateno = 890
value = 5945

[State 910,NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 910,AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 910,0]
type = PosFreeze
trigger1 = 1

[State 910,Explod]
type = Explod
trigger1 = AnimElem = 2
anim = 2100
pos = 0,-60
postype = P1
sprpriority = 1
bindtime = 1
ownpal = 1

[State 910,1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 24,0
time = 4

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 2
pos = 0, 0
time = 13

[State 910,Width]
type = Width
trigger1 = AnimElem = 2 && BackEdgeDist < 40
edge = 20,40

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 3
pos = 0, 0
time = 4

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 4
pos = 0,-55
time = 5

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 5
pos = -11,-59
time = 7

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 6
pos = -12,-51
time = 6

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 7
pos = -17,-78
time = 5

[State 910,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 7
value = 900, 6

[State 910,TargetBind]
type = TargetBind
trigger1 = AnimElem = 8
pos = 10,-56
time = 1

[State 910,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 8
value = 900, 2

[State 910,TargetLifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 8
value = -100

[State 910,10]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 襷投げ（投げられ側）
[Statedef 920]
type = A
movetype = H
physics = N
ctrl = 0

[State 815, ????]
type = ChangeState
triggerall =!(Teammode = simul)
trigger1 = time <= 6
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y"
value = 890

[State 920,AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 920,1]
type = ChangeAnim2
trigger1 = Time = 0
value = 920

[State 920,2]
type = ChangeAnim
trigger1 = Anim = 920 && AnimTime = 0
value = 5050

[State 920,VelSet]
type = VelSet
trigger1 = Anim = 5050 && AnimElem = 1, = 2
persistent = 0
x = -3.2
y = -7.6

[State 920,VelAdd]
type = VelAdd
trigger1 = Anim = 5050 && AnimElem = 1, > 2
y = .43

[State 920,NotHitBy]
type = NotHitBy
trigger1 = Anim = 5050
value = SCA

[State 920,SelfState]
type = SelfState
trigger1 = Anim = 5050 && Vel Y > 0 && Pos Y >= 0
value = 5100

;-------------------------------------------------------------------------------
; 上手投げ（Ｋ通常投げ）
[Statedef 950]
type = S
movetype = A
physics = S
ctrl = 0
anim = 950
velset = 0, 0

[State 900]
type = NotHitBy
trigger1 = 1
value = SCA

[State 950,1]
type = Hitdef
trigger1 = Time = 0
trigger1 = P2MoveType != H
trigger1 = P2StateNo != [150,155]
attr = S, NT
priority = 8,Miss
getpower = 0
givepower = 0
hitflag = M-
numhits = 0
sparkno = -1
p1facing = 1
p2facing = 1
p1stateno = 960
p2stateno = 970
p2getp1state = 1
hitsound = S900, 0
fall = 1
fall.recover = 0

[State 950,2]
type = ChangeState
trigger1 = AnimTime = 0
value = 230

;-------------------------------------------------------------------------------
; 上手投げ（成功）
[Statedef 960]
type = S
movetype = A
physics = S
anim = 960
velset = 0, 0
poweradd = 0

[State 810, ????]
type = ChangeState
triggerall =!(Teammode = simul)
Trigger1 = AnimElemtime(2) = 10
trigger1 = numtarget && target,stateno = 890
value = 5945

[State 960,NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 960,AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 960,0]
type = PosFreeze
trigger1 = Time >= 0

[State 960,Explod]
type = Explod
trigger1 = AnimElem = 1
anim = 2100
pos = 45,-53
postype = P1
sprpriority = 1
bindtime = 1
ownpal = 1

[State 960,1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 34, 0
time = 21

[State 960,Width]
type = Width
trigger1 = AnimElem = 1 && FrontEdgeDist < 35
edge = 35,20

[State 960,2]
type = TargetBind
trigger1 = AnimElem = 4
pos = 19,-53
time = 5

[State 960,3]
type = TargetBind
trigger1 = AnimElem = 5
pos = -1,-40
time = 4

[State 960,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5
value = 900, 7

[State 960,4]
type = TargetBind
trigger1 = AnimElem = 6
pos = -37, 0
time = 1

[State 960,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 6
value = 900, 4

[State 960,Width]
type = Width
trigger1 = AnimElem = 6 && BackEdgeDist < 55
edge = 20,55

[State 960,TargetLifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = -100

[State 960,Explod]
type = Explod
trigger1 = AnimElem = 7
anim = 2320
pos = -30, 0
postype = P1
sprpriority = 2
bindtime = 1
ownpal = 1
facing = -1

[State 960,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 7
value = 900, 5

[State 960,7]
type = SprPriority
trigger1 = AnimElem = 5
value = 0

[State 960,9]
type = Turn
trigger1 = AnimElem = 10

[State 960,13]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
; 上手投げ（投げられ側）
[Statedef 970]
type = A
movetype = H
physics = N
ctrl = 0

[State 840, ????]
type = ChangeState
triggerall =!(Teammode = simul)
trigger1 = time <= 6
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "b"
value = 890

[State 970,Sprite]
type = SprPriority
trigger1 = AnimElem = 5
value = 1

[State 970,0]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 970,1]
type = ChangeAnim2
trigger1 = Time = 0
value = 970

[State 970,2]
type = VelSet
trigger1 = AnimElem = 6, = 5
x = 6.0

[State 970,3]
type = StateTypeSet
trigger1 = AnimElem = 6, = 5
statetype = L
physics = S

[State 970,ChangeAnim]
type = ChangeAnim
trigger1 = Anim = 970 && AnimTime = 0
value = 5110

[State 970,Turn]
type = Turn
trigger1 = Anim = 5110
persistent = 0

[State 970,4]
type = SelfState
trigger1 = Vel X = 0 && Time >= 80
value = IfElse(Alive = 1,5120,5150)

;---------------------------------------------------------------------------
;??????
[Statedef 890]
type    = A
movetype= H
physics = N
velset = 0,0

[State 890, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 890, ????]
type = ChangeState
trigger1 = enemy,stateno = 5945
value = 5940

;---------------------------------------------------------------------------

;=====================================================================
; 特殊動作
;=====================================================================
;
;---------------------------------------------------------------------
; ガードキャンセル緊急回避動作（前）
[Statedef 4000]
type = S
movetype = I
physics = N
ctrl = 0
anim = 4000
velset = 0, 0

[State 4000,0]
type = ChangeState
trigger1 = var(59) = 0
trigger1 = Time = 0
trigger1 = Command = "holdback"
value = 4100

[State 4000,1]
type = SuperPause
trigger1 = Time = 0
time = 10
movetime = 10
anim = S2300
pos = 0,-40
poweradd = -1000

[State 4000,EnvColor]
type = EnvColor
trigger1 = Time = 0
value = 248,248,248
time = 2
under = 1

[State 4000,5]
type = PlaySnd
trigger1 = Time = 1
value = 4000, 0

[State 4000,3]
type = NotHitBy
trigger1 = Time >= 0
value = SCA

[State 4000,4]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 4000,5]
type = VelSet
trigger1 = AnimElem = 3
x = 6.75

[State 4000,6]
type = VelSet
trigger1 = AnimElem = 8
x = 0

[State 3010,AfterImage]
type = AfterImage
trigger1 = Time = 0
time = 24
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 4000,8]
type = VarSet
trigger1 = Time = 0
v = 4
value = 0

[State 4000,Turn]
type = Turn
trigger1 = AnimTime = 0 && P2BodyDist X < -5

[State 4000,10]
type = ChangeState
trigger1 = AnimTime = 0
value = 10
ctrl = 1

;---------------------------------------------------------------------
; 緊急回避動作（前）
[Statedef 4050]
type = S
movetype = I
physics = N
ctrl = 0
anim = 4000
velset = 0, 0

[State 4050,0]
type = NotHitBy
trigger1 = Time < 28
value = SCA

[State 4050,1]
type = HitBy
trigger1 = Time >= 0
value = SC, NT, ST, HT

[State 4050,2]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 4050,3]
type = VelSet
trigger1 = AnimElem = 3
x = 7

[State 4050,4]
type = VelSet
trigger1 = AnimElem = 8
x = 0

[State 4050,5]
type = PlaySnd
trigger1 = Time = 1
value = 4000, 0

[State 3010,AfterImage]
type = AfterImage
trigger1 = Time = 0
time = 14
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 4000,Turn]
type = Turn
trigger1 = AnimTime = 0 && P2Dist X < 0

[State 4050,6]
type = ChangeState
trigger1 = AnimTime = 0
value = 10
ctrl = 1

;---------------------------------------------------------------------
; ガードキャンセル緊急回避動作（後）
[Statedef 4100]
type = S
movetype = I
physics = N
ctrl = 0
anim = 4100
velset = 0, 0

[State 4100,0]
type = SuperPause
trigger1 = Time = 0
time = 10
movetime = 2
anim = S2300
pos = 0,-60
poweradd = -1000

[State 4100,EnvColor]
type = EnvColor
trigger1 = Time = 0
value = 248,248,248
time = 2
under = 1

[State 4100,5]
type = PlaySnd
trigger1 = Time = 1
value = 4000, 0

[State 4100,2]
type = NotHitBy
trigger1 = Time >= 0
value = SCA

[State 4100,3]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 4100,4]
type = VelSet
trigger1 = AnimElem = 4
x = -5.75

[State 4100,5]
type = VelSet
trigger1 = AnimElem = 9
x = 0

[State 3010,AfterImage]
type = AfterImage
trigger1 = Time = 0
time = 25
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 4100,7]
type = VarSet
trigger1 = Time = 0
v = 4
value = 0

[State 4100,9]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------
; 緊急回避動作（後）
[Statedef 4150]
type = S
movetype = I
physics = N
ctrl = 0
anim = 4100
velset = 0, 0

[State 4150,0]
type = NotHitBy
trigger1 = Time >= 0
value = SCA

[State 4150,1]
type = HitBy
trigger1 = Time >= 0
value = SC, NT, ST, HT

[State 4150,2]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 4150,3]
type = VelSet
trigger1 = AnimElem = 4
x = -5.00

[State 4150,4]
type = VelSet
trigger1 = AnimElem = 9
x = 0

[State 4150,5]
type = PlaySnd
trigger1 = Time = 1
value = 4000, 0

[State 3010,AfterImage]
type = AfterImage
trigger1 = Time = 0
time = 14
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 4150,6]
type = ChangeState
trigger1 = AnimTime = 0
value = 10
ctrl = 1

;---------------------------------------------------------------------
; ガードキャンセル吹っ飛ばし攻撃
[Statedef 4500]
type = S
movetype = A
physics = S
ctrl = 0
anim = 4500
velset = 0, 0
poweradd = -1000

[State 4500,0]
type = SuperPause
trigger1 = Time = 0
time = 10
movetime = 2
anim = S2300
pos = 0,-60

[State 4500,2]
type = NotHitBy
trigger1 = AnimElem = 7, < 0
value = SCA

[State 3010,AfterImage]
type = AfterImage
trigger1 = Time = 0
time = 29
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 4500,4]
type = VarSet
trigger1 = Time = 0
v = 4
value = 0

[State 4500,9]
type = Hitdef
trigger1 = Time = 0
attr = S, SA
animtype = Hard
damage    = 70
getpower = 0
givepower = 45
guardflag = M
hitflag = MAF
pausetime = 12,14
sparkno = s2010
guard.sparkno = s2060
sparkxy = -10,-44
hitsound = S300, 4
guardsound = S0, 0
ground.type = High
ground.slidetime = 15*(1+ifelse(var(9)>0, 0.2, 0))
ground.hittime  = 15*(1+ifelse(var(9)>0, 0.2, 0))
ground.velocity = -2,-3.5
air.velocity = -4.2,-3.5
fall = 1
fall.recover = 0
air.recover = 0
recover = 0

[State 4500,PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 20

[State 4500,PosAdd]
type = PosAdd
trigger1 = AnimElem = 11
x = 14

[State 4500,PosAdd]
type = PosAdd
trigger1 = AnimElem = 12
x = 5

[State 4500,PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5
value = 200, 2

[State 4500,10]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;?????

[Statedef 790]
type     = S
movetype = I
physics  = N
anim     = 4000
ctrl     = 0
velset   = 0,0
sprpriority = -2

[State 700, VarSet]
type = VarSet
trigger1 = time = 0
var(16) = 0

[State 700, VarSet]
type = VarSet
trigger1 = prevstateno = 150 || prevstateno = 152
trigger2 = (prevstateno = [200,499])
var(16) = 1

[State 700, PowerAdd]
type = PowerAdd
triggerall = var(40) <= 0
trigger1 = var(16) = 1 && AnimElem = 1
value = -1000

[State 700, VarAdd]
type = VarAdd
triggerall = var(40) > 0
trigger1 = var(16) = 1 && AnimElem = 1
var(39) = -1000

[State 700, ??]
type = palfx
trigger1 = var(16) = 1 && AnimElem = 1
time = 5
add = 230,230,230

[State 700, ??]
type = AfterImage
triggerall = var(16) = 0
trigger1 = AnimElem = 1
time = 15
length = 7
framegap = 3
trans = add1
palcontrast = 128,128,128
paladd = 0,0,0
palmul = 1,1,1

[State 700, ??]
type = AfterImage
trigger1 = var(16) = 1 && AnimElem = 1
time = 999
length = 7
framegap = 3
palcolor = 0
trans = add1
palbright = 16,0,48
palcontrast = 200,184,240
paladd = 0,0,0
palmul = 1,1,1

[State 700, ??]
type = AfterImage
trigger1 = AnimTime = 0
time = 1

[State 700, ????]
type = SuperPause
trigger1 = var(16) = 1 && AnimElem = 1
anim = -1
movetime = 10
time = 10
p2defmul = 1.0
darken = 0

[State 700, ???????]
type = Explod
trigger1 = var(16) = 1 && AnimElem = 1
anim = 2300
pos = 0, -60
sprpriority = 20
ownpal = 1
bindtime = 1
supermove = 1

[State 700, ???]
type = HitBy
triggerall = var(16) = 0
trigger1 = AnimElem = 6, <= 0
value = SC, NT, ST, HT

[State 700, ??]
type = NotHitBy
triggerall = var(16) = 1
trigger1 = 1
value = SCA

[State 700, ?????]
type = PlaySnd
trigger1 = AnimElem = 2
value = s4000,0
channel = 10

[State 700, ???]
type = VelSet
trigger1 = AnimElem = 3
x = ifelse((PrevStateNo = 100 || var(16) = 1),7,5)

[State 700, ????]
type = VelSet
trigger1 = AnimElem = 7
x = 0

[State 700, ?????????]
type = PlayerPush
trigger1 = AnimElemTime(1) > 0
value = 0

[State 700, ??]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;-----------------
;-enemigo rechaza el agarre,pasas a esta animaci?.
[statedef 811]
type = S
Movetype = I
physics = S
Anim = 5945
poweradd = 0
ctrl = 0

[State 2000,]
type = RemoveExplod
trigger1 = time = 0
ID = 6020

[State 2000,]
type = RemoveExplod
trigger1 = time = 0
ID = 1400

[State 811, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA

[State 811, PlaySnd]
type = playsnd
trigger1 =TIME=1
value = 900, 5
volume =150

[State 811, Freeze]
type = Pause
trigger1 = Time = 0
time = 3
movetime = 3
ignorehitpause = 1

[State 811, Flash]
type = Envcolor
trigger1 = Time = 2
value = 248,248,248
time = 1
under = 1
ignorehitpause = 1

[State 811, Screen Shake]
type = EnvShake
trigger1 = Time = 5
time = 10
amp = -2


[State 811, Get back]
type = Velset
trigger1 = time = [3,10]
x = -4.5
ignorehitpause = 1


[state 811 ,5]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------
;-enemigo escapa al agarre,pasas a esta animaci?.
[statedef 812]
type = S
Movetype = A
physics = S
Anim = 5940
poweradd = 0
ctrl = 0


[State 812, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA


[State 812, PlaySnd]
type = PlaySnd
trigger1 =TIME=1
value = S3,1
;volume =150


[state 812 ,5]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;----------------------------------------------------------------------

;---------------------------------------------------------------------
; 各種ジャンプ
[Statedef 40]
type = S
movetype = I
physics = S
anim = 40
ctrl = 0

[State 40]
type = changeState
trigger1= var(59)
value = 1

[State 4600,0]
type = VarSet
trigger1 = Var(28) = 1
v = 26
value = 1

[State 4600,1]
type = VarSet
trigger1 = Time = 0
v = 27
value = 0

[State 4600,2]
type = VarSet
trigger1 = Command = "holdfwd"
v = 27
value = 1

[State 4600,3]
type = VarSet
trigger1 = Command = "holdback"
v = 27
value = -1

[State 40,VelSet]
type = VelSet
triggerall = AnimTime = 0
trigger1 = PrevStateNo != 100 && Var(26) = 0
trigger2 = PrevStateNo = 100 && Var(27) != 1
x = IfElse(Var(27) = 0,0,IfElse(Var(27) = -1,Const(velocity.jump.back.x),Const(velocity.jump.fwd.x)))
y = Const(velocity.jump.y)

[State 40,VelSet]
type = VelSet
triggerall = AnimTime = 0
trigger1 = PrevStateNo != 100 && Var(26) = 1
trigger2 = PrevStateNo = 100 && Var(27) = 1
x = IfElse(Var(27) = 0,0,IfElse(Var(27) = -1,Const(velocity.runjump.back.x),Const(velocity.runjump.fwd.x)))
y = Const(velocity.jump.y)

[State 4600,A]
type = VelSet
triggerall = AnimTime = 0
trigger1 = Command != "holdup"
y = -6.02

[State 4600,9]
type = AfterImage
trigger1 = Var(26) = 1 || (PrevStateNo = 100 && Var(27) = 1)
trigger1 = Var(27) != 0
time = 16
length = 4
frameGap = 1
timeGap = 2
PalAdd = 0,0,0
palmul = 1,1,1
PalBright = 0, 0, 0
PalContrast = 70,70,70
trans = add1

[State 40,PlaySnd]
type = PlaySnd
triggerall = AnimTime = 0
trigger1 = Var(26) = 1 || (PrevStateNo = 100 && Var(27) = 1)
trigger1 = Var(27) != 0
value = 40, 1

[State 40,PlaySnd]
type = PlaySnd
triggerall = AnimTime = 0
trigger1 = Var(26) = 0 || (PrevStateNo = 100 && Var(27) != 1)
value = 40, 0

[State 4600,10]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; 着地
[Statedef 52]
type    = S
physics = S
ctrl = 0
anim = 47
velset = 0, 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, Turn]
type = Turn
trigger1 = Time = 0
trigger1 = p2dist x < 0

[State -3,前跳?吸的技能，主要是大蛇的掏心]
Type = ChangeState
TriggerAll = var(59)
triggerAll = AnimTime = 0
TriggerAll = (EnemyNear,MoveType = A || EnemyNear,MoveType = I) && !EnemyNear,Ctrl
TriggerAll = EnemyNear,AnimTime >= -4
TriggerAll = EnemyNear,StateNo >= 2000
TriggerAll = EnemyNear,StateType != A

Trigger1 = EnemyNear,BackEdgeBodyDist > 10
Trigger1 = P2Dist X = [50, 100]
Trigger1 = var(50) := 390701 
Trigger1 = var(10) := 4

Trigger2 = EnemyNear,BackEdgeBodyDist > 10
Trigger2 = P2Dist X <= 50
Trigger2 = var(50) := 3907012
Trigger2 = var(10) := 2

Trigger3 = EnemyNear,BackEdgeBodyDist <= 0
Trigger3 = P2Dist X < 80
Trigger3 = var(50) := 390703
Trigger3 = var(10) := 2

Value = 39
IgnoreHitPause = 1


[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;================================================================================
; Tripped get-hit (knocked away)
[Statedef 5071]
type    = A
movetype= H
physics = N

[State 5071, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5071, 2] ;Acceleration
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5071, 3] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y + Vel y >= 0
type = ChangeState
value = 5100 

;================================================================================
; Downed get-hit (hit ground from fall)
[Statedef 5100]
type    = L
movetype= H
physics = N

[State 5100, 2004.04.14 behavior]
type = null;VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x < -1
x = -1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;Downed get-hit (lying down)

[State 5100, 10]
type = PlaySnd
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
trigger1 = Time = 1
value = 900,3
channel = 1
volume = 200

[State 5100, Explod]
type = Explod
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
trigger1 = !time && (sysvar(1) < 14)
anim = 2310
pos = 0,0
postype = p1  ;p2,front,back,left,right
sprpriority = -4
ownpal = 1

[State 3501, 3]
type = Explod
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
triggerall = (anim = [5051,5059]) || (anim = [5061,5069])
triggerall = SelfAnimExist(5100 + (anim % 10))
trigger1 = time = 0
anim = 2310
sprpriority = -4
postype = p1
pos = -5,0
bindtime = 1
ownpal = 1

[State 3501, 4]
type = Explod
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
triggerall = (anim = [5051,5059]) || (anim = [5061,5069])
triggerall = SelfAnimExist(5100 + (anim % 10))
trigger1 = time = 0
anim = 2310
sprpriority = 4
postype = p1
pos = -5,0
bindtime = 1
ownpal = 1

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101 ;Downed get-hit (bounce off ground)

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

; HIT_BOUNCE (bounce into air)
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5101, 5] ;Reduce speed
type = VelMul
trigger1 = time = 0
x = .6
y = .8

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = .5

[State 5101, 7] ;Hit ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5110

;================================================================================
; HIT_LIEDOWN
[Statedef 5110]
type    = L
movetype= H
physics = N

[State 5110, 0]
type = ChangeState
trigger1 = 1
value = 5111
;================================================================================
; HIT_LIEDOWN
[Statedef 5111]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5100, 10]
type = PlaySnd
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
trigger1 = Time = 1
value = 900,3
channel = 1
volume = 200

[State 5110, 7]
type = Explod
triggerALL = stagevar(info.name) != "Y"
triggerall = stagevar(info.name) != "Z"
trigger1 = Time = 0 && prevstateno != 5120
trigger1 = !SysVar(0)
anim = 2310
postype = P1
pos = -32, 0 ;32, 0
facing = -1
under = 1
sprpriority = 2
ownpal = 1

;=================

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 11] 
type = ChangeState
trigger1 = name = "Hinako"
trigger1 = time = 10 + 10*(anim=5111||anim=5112)
trigger2 = name != "Hinako"
trigger2 = time = 30
value = 5120

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine


;---------------------------------------------------------------------
; HIT_FALLRECOVER (still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = NotHitBy
trigger1 = CanRecover
value = SCA

[State 5200, 4]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5201

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 5201]
type     = S
movetype = I
physics  = N
VelSet   = 0,0
anim     = 5200
ctrl     = 0
sprpriority = 2

[State 5201, 1]
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 3]
type = PalFX
trigger1 = time = 0
time = 1

[State 5201, 3]
type = playSnd
trigger1 = time = 0
value = 4000,0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5201, 5]
type = PlaySnd
trigger1 = AnimElem = 1
value = s10,17
channel = 10

[State 5201, 6]
type = VelSet
trigger1 = AnimElem = 1
x = -8

[State 5201, 7]
type = VelMul
trigger1 = AnimElemTime(1) > 0
x = .85

[State 5201, 8]
type = VelSet
trigger1 = AnimElem = 5
x = 0

[State 5201, 9]
type = PlayerPush
trigger1 = 1
value = 0

[State 5201, 4]
type = NotHitBy
trigger1 = AnimTime = 0
value = SCA
time = 3

[State 5201, 11]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------

;---------------------------------------------------------------------------
; 叩き付けダウン

[Statedef 5610]
type     = U
movetype = H
physics  = N
velset   = 0,0

[State 5610, 1]
type = PosSet
trigger1 = StateType != A
y = 0

;------------------------
;地上

[State 5610, 2]
type = ChangeAnim
trigger1 = StateType = S
trigger1 = SelfAnimExist(5610) && authorname = "Mondregon"
value = 5610

[State 5610, 3]
type = ChangeAnim2
trigger1 = StateType = S
trigger1 =!(SelfAnimExist(5610) && authorname = "Mondregon")
value = 5611

[State 5610, 4]
type = ChangeAnim
trigger1 = StateType = C
trigger1 = SelfAnimExist(5615) && authorname = "Mondregon"
value = 5615

[State 5610, 5]
type = ChangeAnim2
trigger1 = StateType = C
trigger1 =!(SelfAnimExist(5615) && authorname = "Mondregon")
value = 5616

;------------------------
;空中

[State 5610, 6]
type = ChangeAnim
trigger1 = StateType != A
value = 5610

;------------------------
;ダウン追撃

[State 5610, 7]
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse(SelfAnimExist(5090),5090,5080)

[State 5610, 8]
type = VarAdd
trigger1 = time = 0
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5610, 9]
type = ChangeAnim
trigger1 = StateType = L
value = sysvar(2)

;------------------------

[State 5610, 11]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = StateType = S || StateType = C
value = 5611

[State 5610, 12]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = StateType = A
value = 5613

[State 5610, 13]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = StateType = L
value = 5030

;------------------------
; 地上

[Statedef 5611]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5611, 1]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5611, 2]
type = NotHitBy
trigger1 = Time = 1
value = SCA
time = 1

[State 5611, 3]
type = FallEnvShake
trigger1 = Time = 0

[State 5611, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 5612

[Statedef 5612]
type    = L
movetype= H
physics = N

[State 5612, 1]
type = ChangeAnim
trigger1 = time = 0
value = ifelse((Anim = 5610 || Anim = 5615),ifelse(SelfAnimExist(5612),5612,5160),5161)

[State 5612, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5612, 3]
type = VelSet
trigger1 = Time = 0
y = -4

[State 5612, 4]
type = VelAdd
trigger1 = 1
y = .5

[State 5612, 5]
type = ChangeAnim
trigger1 = Anim = 5612
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5162

[State 5612, 6]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5692

;-------------------------
; 空中

[Statedef 5613]
type     = A
movetype = H
physics  = N

[State 5613, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 5050

[State 5613, 2]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5613, 3]
type = VelSet
trigger1 = time = 0
x = ifelse(gethitvar(xvel) <= 0,-1,1) * facing * 9
y = 10

[State 5613, 4]
type = VelAdd
trigger1 = 1
y = .5

[State 5613, 5]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5614

[Statedef 5614]
type    = L
movetype= H
physics = N
velset   = 0,0

[State 5614, 1]
type = FallEnvShake
trigger1 = Time = 0

[State 5614, 2]
type = NotHitBy
trigger1 = Time = 1
value = SCA
time = 1

[State 5614, 3]
type = ChangeAnim
trigger1 = time = 0
value = 5100

[State 5614, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5614, 6]
type = PosFreeze
trigger1 = 1

[State 5614, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 5615

[Statedef 5615]
type    = L
movetype= H
physics = N

[State 5615, 1]
type = ChangeAnim
trigger1 = time = 0
value = 5161

[State 5615, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5615, 3]
type = VelSet
trigger1 = time = 0
x = ifelse(gethitvar(xvel) <= 0,-1,1) * facing * 2
y = -6

[State 5615, 4]
type = VelAdd
trigger1 = 1
y = .5

[State 5615, 5]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5692

;------------------------
; 追い討ち

[Statedef 5616]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5616, 1]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5616, 2]
type = FallEnvShake
trigger1 = Time = 0

[State 5616, 3]
type = ChangeAnim
trigger1 = time < 3
value = Anim

[State 5616, 4]
type = PalFX
trigger1 = time = 3
time = 1

[State 5616, 5]
type = VelSet
trigger1 = time = 3
x = ifelse(gethitvar(xvel) <= 0,-1,1) * facing * 4
y = -6

[State 5616, 6]
type = VelAdd
trigger1 = time >= 3
y = .5

[State 5616, 7]
type = ChangeAnim
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5161 + (anim % 10)

[State 5616, 8]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5692

;---------------------------------------------------------------------------
; 壁バウンド

[Statedef 5600]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5600, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5600, 2]
type = ChangeAnim
triggerall = SelfAnimExist(5900)
trigger1 = Time = 0
value = 5900

[State 5600, 3]
type = ChangeAnim2
triggerall =!SelfAnimExist(5900)
trigger1 = Time = 0
value = 5600

[State 5600, 4]
type = PlayerPush
trigger1 = 1
value = 0

[State 5600, 5]
type = ChangeState
trigger1 = HitShakeOver = 1
value = 5601

[Statedef 5601]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5601, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5601, 2]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 5601, 3]
type = PlayerPush
trigger1 = 1
value = 0

[State 5601, 4]
type = VelSet
trigger1 = time = 0
x = ifelse(gethitvar(xvel)<0,-1,1)*facing*16
y = -4.5

[State 5601, 5]
type = VelAdd
trigger1 = 1
y = .5

[State 5601, 6]
type = ChangeState
trigger1 = vel x < 0 && backedgebodydist <= 10
trigger2 = vel x > 0 && frontedgebodydist <= 10
value = 5602

[State 5601, 7]
type = SelfState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5100

[Statedef 5602]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5602, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5602, 2]
type = ChangeAnim
triggerall = SelfAnimExist(5901)
trigger1 = Time = 0
value = 5901

[State 5602, 3]
type = ChangeAnim2
triggerall =!SelfAnimExist(5901)
trigger1 = Time = 0
value = 5601

[State 5602, State]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = Time = 16
value = 5603

[Statedef 5603]
type    = A
movetype= H
physics = N

[State 5603, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5603, 2]
type = ChangeAnim
triggerall = SelfAnimExist(5902)
trigger1 = Time = 0
value = 5902

[State 5603, 3]
type = ChangeAnim
triggerall =!SelfAnimExist(5902)
trigger1 = Time = 0
value = 5050

[State 5603, 4]
type = VelSet
trigger1 = Time = 0
x = ifelse(gethitvar(xvel)<0,-1,1)*facing*-1
y = -1

[State 5603, 5]
type = VelAdd
trigger1 = 1
y = .5

[State 5603, 6]
type = ChangeAnim
triggerall = Anim = 5050
trigger1 = SelfAnimExist(anim+10)
trigger1 = Vel Y >= 1;ifelse(anim = 5050, 1, -2)
value = anim+10
persistent = 0

[State 5603, 7]
type = SelfState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------

[Statedef 5605]
type     = A
movetype = H
physics  = N
velset   = 0,0


[State 5605, 3]
type = ChangeAnim2
trigger1 = Time = 0
value = 5900

[State 5605, 4]
type = PlayerPush
trigger1 = 1
value = 0

[State 5605, 5]
type = ChangeState
trigger1 = HitShakeOver = 1
value = 5606

[Statedef 5606]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5606, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5606, 2]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 5606, 3]
type = PlayerPush
trigger1 = 1
value = 0

[State 5606, 4]
type = VelSet
trigger1 = time = 0
x = ifelse(gethitvar(xvel)<0,-1,1)*facing*16
y = -7

[State 5606, 5]
type = VelAdd
trigger1 = 1
y = .5

[State 5606, 6]
type = ChangeState
trigger1 = Vel X < 0 && BackEdgeBodyDist <= 32
trigger2 = Vel X > 0 && FrontEdgeBodyDist <= 32
value = 5607

[State 5606, 7]
type = SelfState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5100

[Statedef 5607]
type     = A
movetype = H
physics  = N
velset   = 0,0

[State 5607, 1]
type = null;NotHitBy
trigger1 = 1
value = SCA

[State 5607, 2]
type = ChangeAnim
triggerall = SelfAnimExist(5901)
trigger1 = Time = 0
value = 5901

[State 5607, 3]
type = ChangeAnim2
triggerall =!SelfAnimExist(5901)
trigger1 = Time = 0
value = 5601

[State 5607, State]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = Time = 16
value = 5608

[Statedef 5608]
type    = A
movetype= H
physics = N

[State 5608, 2]
type = Turn
trigger1 = Time = 0

[State 5608, 3]
type = ChangeAnim
triggerall = SelfAnimExist(5903)
trigger1 = Time = 0
value = 5903

[State 5608, 4]
type = ChangeAnim
triggerall =!SelfAnimExist(5903)
trigger1 = Time = 0
value = 5050

[State 5608, 5]
type = VelSet
trigger1 = Time = 0
x = ifelse(gethitvar(xvel)<0,-1,1)*facing*-2
y = -12

[State 5608, 6]
type = VelAdd
trigger1 = 1
y = .55

[State 5608, 7]
type = ChangeAnim
triggerall = Anim = 5050
trigger1 = SelfAnimExist(anim+10)
trigger1 = Vel Y >= 1;ifelse(anim = 5050, 1, -2)
value = anim+10
persistent = 0

[State 5608, 8]
type = SelfState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; スライドダウン

[Statedef 5620]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5620, 1]
type = ChangeAnim
trigger1 = 1
value = 5030

[State 5620, 2]
type = ChangeState
trigger1 = HitShakeOver = 1
value = 5621

[Statedef 5621]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5621, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5621, 2]
type = ChangeAnim
Trigger1 = Time = 0
value = 5050

[State 5621, 3]
type = VelSet
trigger1 = AnimElem = 1
x = ifelse(gethitvar(xvel) <= 0,-1,1) * facing * 7
y = -4

[State 5621, 4]
type = Veladd
trigger1 = AnimElemtime(1) >= 0
y = .42

[State 5621, 5]
type = ChangeState
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 5622

[Statedef 5622]
type    = L
movetype= H
physics = N
velset = ifelse(Vel X < 0,-1,1)*5,0

[State 5622, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 5620

[State 5622, 2]
type = PosSet
trigger1 = time = 0
y = 0

[State 5622, 3]
type = VelMul
trigger1 = 1
x = .92

[State 5622, 4]
type = VelSet
trigger1 = time = 20
x = 0
y = 0

[State 5622, 5]
type = ChangeAnim
trigger1 = time = 20
value = 5110

[State 5622, 6]
type = SelfState
trigger1 = time = 40
trigger1 = Alive
value = 5120

[State 5622, 7]
type = SelfState
trigger1 = time = 40
trigger1 = !Alive
value = 5150

;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 5692]
type    = L
movetype= H
physics = N

[State 1032, end]
type = NotHitBy
trigger1 = time = 20
value = SCA

[State 5692, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5692, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5111 + (anim % 10)
persistent = 0

[State 5692, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5692, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5692, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5692, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5692, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5692, 8]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 5692, 9] ;For hit up type
type = ChangeAnim
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5111 + (anim % 10)
persistent = 0

[State 5692, 10] ;For normal
type = ChangeAnim
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5111
persistent = 0

[State 5692, 11] ;If just died
type = SelfState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5692, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5692, 13]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5692, 14]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 5692, ChangeState]
type = ChangeState
trigger1 = Time = 40
value = 5693

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; HIT_GETUP
[Statedef 5693]
type    = L
movetype= I
physics = N

[State 5693, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5693, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5693, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 5693, 3]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5693, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

[State 5693, 5]
type = NotHitBy
trigger1 = AnimTime = 0
value = SCA
time = 1

[State 5693, 6]
type = NotHitBy
trigger1 = AnimTime = 0
value2 = , AT
time = 8

[State 5693, 7]
type = SelfState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;投げ抜け(相手)

[Statedef 5940]
type     = S
movetype = I
physics  = N
velset   = 0,0
;anim     = 5940
ctrl     = 0
sprpriority = 1

[State 5940, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5940, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5940, ChangeAnim]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5940)
value = 5940

[State 5940, ChangeAnim]
type = ChangeAnim
trigger1 = Time = 0
trigger1 =!SelfAnimExist(5940)
value = 120

[State 5940, ChangeAnim]
type = ChangeAnim
trigger1 = Anim = 120
trigger1 = AnimTime = 0
value = 130

[State 5940, SelfState]
type = SelfState
trigger1 = AnimTime = 0
trigger2 = Time = 36
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;投げ抜け(自分)

[Statedef 5945]
type     = S
movetype = I
physics  = N
velset   = 0,0
anim     = 5945
ctrl     = 0
sprpriority = 1

[State 5945, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5945, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5945, PlaySnd]
type = PlaySnd
trigger1 = AnimElemTime(2) = 1
value = s6,2

[State 5945, AssertSpecial]
type = AssertSpecial
trigger1 = AnimElemTime(2) = 1
flag = NoFG
flag2 = NOBG
flag3 = GlobalNoShadow

[State 5945, EnvColor]
type = EnvColor
trigger1 = AnimElemTime(2) = 1
time = 1
value = 255,255,255
under = 1

[State 5945, VelSet]
type = VelSet
trigger1 = AnimElemTime(2) = 1
x = -12

[State 5945, VelMul]
type = VelMul
trigger1 = AnimElemTime(2) >= 2
x = .85

[State 5945, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 5945, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = Time = 36
value = 0
ctrl = 1
;=====================================================================
; Sistem Counter (1/2)
;=====================================================================
[Statedef 6500]
type = A
movetype = I
physics = N
anim = 9999
velset = 0,0
ctrl = 0
[State 6500, VarSet]
type = VarSet
trigger1 = time = 0
var(1) = -52

[State 6500, VarAdd]
type = VarAdd
trigger1 = time < 10
var(1) = 10

[State 6500, VarAdd]
type = VarAdd
trigger1 = time > 59
var(1) = -10

[State 6500]
type = PlaySnd
trigger1 = time = 0
value = 0,2501

[State 6500, Explod]
type = Explod
triggerall = TeamSide = 1
trigger1 = time < 10
trigger2 = time > 59
anim = 6500
id = 6500
ontop = 1
postype = left
pos = var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6500, Explod]
type = Explod
triggerall = TeamSide = 1
trigger1 = time = 10
anim = 6501
id = 6500
ontop = 1
postype = left
pos = var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6500, Explod]
type = Explod
triggerall = TeamSide = 2
trigger1 = time < 10
trigger2 = time > 59
anim = 6500
id = 6500
ontop = 1
postype = right
pos = -var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6500, Explod]
type = Explod
triggerall = TeamSide = 2
trigger1 = time = 10
anim = 6501
id = 6500
ontop = 1
postype = right
pos = -var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6500, DestroySelf]
type = DestroySelf
trigger1 = time = 70

;=====================================================================
; Sistem Counter (2/2)
;=====================================================================
[Statedef 6510]
type = A
movetype = I
physics = N
anim = 9999
velset = 0,0
ctrl = 0

[State 6510, 0]
type = EnvColor
trigger1 = time = 0
value = 255,255,255
time = 1
under = 1
ignorehitpause = 1
persistent = 0

[State 6510, VarSet]
type = VarSet
trigger1 = time = 0
var(1) = -52

[State 6510, VarAdd]
type = VarAdd
trigger1 = time < 10
var(1) = 10

[State 6510, VarAdd]
type = VarAdd
trigger1 = time > 59
var(1) = -10

[State 6510, Explod]
type = Explod
triggerall = TeamSide = 1
trigger1 = time < 10
trigger2 = time > 59
anim = 6510
id = 6510
ontop = 1
postype = left
pos = var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6510, Explod]
type = Explod
triggerall = TeamSide = 1
trigger1 = time = 10
anim = 6511
id = 6510
ontop = 1
postype = left
pos = var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6510, Explod]
type = Explod
triggerall = TeamSide = 2
trigger1 = time < 10
trigger2 = time > 59
anim = 6510
id = 6510
ontop = 1
postype = right
pos = -var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6510, Explod]
type = Explod
triggerall = TeamSide = 2
trigger1 = time = 10
anim = 6511
id = 6510
ontop = 1
postype = right
pos = -var(1),88
bindtime = -1
supermove = 1
pausemovetime = 99999999999999
ownpal = 1
scale = .5,.5

[State 6510, DestroySelf]
type = DestroySelf
trigger1 = time = 70

;====================================================
; Max-On (1/4)
;====================================================
[Statedef 70099]
type = S
ctrl = 0
anim = 6000
velset = 0,0
movetype = I
physics = N
sprpriority = 1
poweradd = -1000

[State 700];
type = PlaySnd
trigger1 = animelem = 3
value = 2000,0

[state a]
type = varset
trigger1 = time = 0
v = 23
value = 900

[State a]
type = Explod
trigger1 = time = 0
anim = 2200
sprpriority = 3
postype = p1
pos = 14,-70
bindtime = 1
ownpal = 1
supermovetime = 999

[State 1020, 4]
type = EnvShake
trigger1 = animelem = 3
time = 10
ampl = -5
freq = 95
phase = 95

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;====================================================
; Max-On Extra Shadow
;====================================================
[Statedef 70091]
type = S
ctrl = 0
anim = 6001
velset = 0,0
movetype = I
physics = N
sprpriority = 1

[State a];1
type = palfx
trigger1 = gametime % 2 = 0
time = 1
add = 100,100,40
ignorehitpause = 1

[State 7000, DestroySelf]
type = DestroySelf
trigger1 = animTime = 0

;====================================================
; Max-On (2/4)
;====================================================
[Statedef 70199]
type = S
ctrl = 0
anim = 6002
velset = 0,0
movetype = I
physics = N
sprpriority = 1
poweradd = -2000

[State a]
type = null
trigger1 = time = 0
stateno = 70091
sprpriority = -3
postype = p1
pos = 10,0
bindtime = 1
under = 0
ownpal = 1
supermovetime = 999

[State 00];
type = PlaySnd
trigger1 = time = 0
value = 7500,0

[state a]
type = varset
trigger1 = time = 0
v = 23
value = 900

[State 2, CAMBIO DE ESTADO]
type = Changestate
triggerall = var(59) = 0
trigger1 = command = "holdfwd"
value = 100
ctrl = 1

[State 2, CAMBIO DE ESTADO]
type = ChangeState
triggerall = var(59) = 0
trigger1 = animtime = 0
trigger1 = command != "holdfwd"
value = 100
ctrl = 1

[State 2, CAMBIO DE ESTADO]
type = ChangeState
trigger1 = animtime = 0
value = ifelse(var(59),1,0)
ctrl = ifelse(var(59),0,1)


;====================================================
; Max-On (3/4)
;====================================================
[Statedef 7750]
type = A
ctrl = 0
anim = 10000
velset = 0,0
movetype = I
physics = N
sprpriority = 10

;---------------------[]
[state a]
type = varset
trigger1 = time = 0
v = 1
value = 0

[state a]
type = changestate
triggerall = root,movetype != H
trigger1 = root,var(23) = 900
value = 7751


[state a]
type = changestate
triggerall = root,movetype != H
trigger1 = root,var(23) = 900
trigger2 = root,stateno = 70199
value = 7751


[state a]
type = changestate
triggerall = root,movetype != H
trigger1 = root,var(23) = 900
trigger2 = root,stateno = 70099
value = 7751

;====================================================
; Max-On (4/4)
;====================================================
[Statedef 7751]
type = A
ctrl = 0
anim = 1000099
velset = 0,0
movetype = I
physics = N
sprpriority = 10

;---------------------[透過]
[state a]
type = null;Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

;---------------------[]
[state -2,a];ゲージ枠a
type = Explod
triggerall = RoundState <= 2
trigger1 = Facing = 1
trigger1 = numexplod(7730) = 0
anim = 7730
id = 7730
postype = back
bindtime = -1
pos = 56,221
sprpriority = 996
removetime = -1
ownpal = 1
;ontop = 1
IGNOREHITPAUSE = 1

[state -2,a];ゲージ枠a
type = Explod
triggerall = RoundState <= 2
trigger1 = Facing = -1
trigger1 = numexplod(7730) = 0
anim = 7731
id = 7730
postype = back
bindtime = -1
pos = 56,221
sprpriority = 996
removetime = -1
ownpal = 1
facing = 1
;ontop = 1
IGNOREHITPAUSE = 1

[state a]
type = ModifyExplod
trigger1 = time <= 33
ID = 7730
scale = 1,var(1)*0.01

[state a]
type = removeexplod
trigger1 = RoundState > 2
id = 7730

;---------------------[]
[state a]
type = varset
trigger1 = time = 0
v = 1
value = 0

[state a]
type = varadd
trigger1 = time <= 4
v = 1
value = 20

[state a]
type = varset
trigger1 = time = 5
v = 1
value = 100

[state a]
type = varadd
trigger1 = time >= 27
v = 1
value = -20

[state a]
type = varset
trigger1 = time = 32
v = 1
value = 100

;---------------------[]
[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = invisible

;---------------------[ゲージ量]
[state -2,a];ゲージ量
type = Explod
triggerall = RoundState <= 2
trigger1 = Facing = 1
trigger1 = time >= 32
anim = 7732
id = 7732
postype = left
bindtime = -1
pos = 56,221;5+4
sprpriority = 2997
;removetime = -1
ownpal = 1
;ontop = 1
IGNOREHITPAUSE = 1

[state -2,a];ゲージ量
type = Explod
triggerall = RoundState <= 2
trigger1 = Facing = -1
trigger1 = time >= 32
anim = 7732
id = 7732
postype = right
bindtime = -1
pos = -56,221
sprpriority = 997
;removetime = -1
ownpal = 1
facing = -1
;ontop = 1
IGNOREHITPAUSE = 1

[state a]
type = ModifyExplod
trigger1 = 1
ID = 7732
scale = root,var(23) * 0.001112,1

[state a]
type = removeexplod
trigger1 = RoundState > 2
id = 7732

;---------------------[]
[state a]
type = removeexplod
trigger1 = root,var(23) = 0
id = 7730

[state a]
type = removeexplod
trigger1 = root,var(23) = 0
id = 7732

[state a]
type = changestate
trigger1 = root,var(23) = 0
value = 7750

;===========================================================================
;======================================================
;POWER BAR
[Statedef 7500]
type = A
ctrl = 0
anim = 9999
velset = 0,0
movetype = I
physics = N
sprpriority = 10

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = invisible

[state a]
type = null;Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256


;---------------------[]
[state -2,a];ゲージ枠a
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7501) = 0
anim = 7501
id = 7501
postype = back
bindtime = -1
pos = 36,230
sprpriority = 98
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ枠a
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7501) = 0
anim = 7501
id = 7501
postype = back
bindtime = -1
pos = 36,230
sprpriority = 98
removetime = -1
ownpal = 1
facing = 1
ontop = 1

[state -2,a];ゲージ枠b
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7502) = 0
anim = 7502
id = 7502
postype = back
bindtime = -1
pos = 36,230
sprpriority = 98
removetime = -1
ownpal = 1
ontop = 1
trans = addalpha
alpha = 250,130

[state -2,a];ゲージ枠b
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7502) = 0
anim = 7502
id = 7502
postype = back
bindtime = -1
pos = 36,230
sprpriority = 98
removetime = -1
ownpal = 1
facing = 1
ontop = 1
trans = addalpha
alpha = 250,130

;---------------------[ゲージ量]
[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7520) = 0
anim = 7520
id = 7520
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7521) = 0
anim = 7521
id = 7521
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7522) = 0
anim = 7522
id = 7522
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7523) = 0
anim = 7523
id = 7523
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7524) = 0
anim = 7524
id = 7524
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7520) = 0
anim = 7520
id = 7520
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7521) = 0
anim = 7521
id = 7521
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7522) = 0
anim = 7522
id = 7522
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7523) = 0
anim = 7523
id = 7523
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

[state -2,a];ゲージ量
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7524) = 0
anim = 7524
id = 7524
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

;ゲージLV1
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7520)
ID = 7520;      power***〜***の間はXsizeを変動、***以上でXsize=.52、それ以外はXsize=0で消す。
scale = ifelse((root,Power<1000),(root,Power)/1000.0,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV2
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7521)
ID = 7521;      power***〜***の間はXsizeを変動、***以上でXsize=.52、それ以外はXsize=0で消す。
scale = ifelse((root,Power=[1000,1999]),(root,Power-1000)/1000.0,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV3
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7522)
ID = 7522;      power***〜***の間はXsizeを変動、***以上でXsize=.52、それ以外はXsize=0で消す。
scale = ifelse((root,Power=[2000,2999]),(root,Power-2000)/1000.0,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV4
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7523)
ID = 7523;      power***〜***の間はXsizeを変動、***以上でXsize=.52、それ以外はXsize=0で消す。
scale = ifelse((root,Power=[3000,3999]),(root,Power-3000)/1000.0,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV5
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7524)
ID = 7524;      power***〜***の間はXsizeを変動、***以上でXsize=.52、それ以外はXsize=0で消す。
scale = ifelse((root,Power=[4000,4999]),(root,Power-4000)/1000.0,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999


[state -2,a];MAX
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = power >= 5000
trigger1 = numexplod(7525) = 0
anim = 7525
id = 7525
postype = left
bindtime = -1
pos = 36,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];MAX
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = power >= 5000
trigger1 = numexplod(7525) = 0
anim = 7526
id = 7525
postype = right
bindtime = -1
pos = -36,230
sprpriority = 97
removetime = -1
ownpal = 1
facing = -1
ontop = 1

[state a]
type = removeexplod
trigger1 = power < 5000
id = 7525


[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7510) = 0
anim = 7510
id = 7510
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7511) = 0
anim = 7511
id = 7511
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7512) = 0
anim = 7512
id = 7512
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7513) = 0
anim = 7513
id = 7513
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7514) = 0
anim = 7514
id = 7514
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = 1
trigger1 = numexplod(7515) = 0
anim = 7515
id = 7515
postype = back
bindtime = -1
pos = 17,230
sprpriority = 97
removetime = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7510) = 0
anim = 7510
id = 7510
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7511) = 0
anim = 7511
id = 7511
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7512) = 0
anim = 7512
id = 7512
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7513) = 0
anim = 7513
id = 7513
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7514) = 0
anim = 7514
id = 7514
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

[state -2,a];ゲージ数
type = Explod
triggerall = root,var(37) = 0
trigger1 = Facing = -1
trigger1 = numexplod(7515) = 0
anim = 7515
id = 7515
postype = back
bindtime = -1
pos = 16,230
sprpriority = 97
removetime = -1
facing = -1
ownpal = 1
ontop = 1

;ゲージLV1
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7510)
ID = 7510
scale = ifelse((root,Power<1000),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV2
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7511)
ID = 7511
scale = ifelse((root,Power=[1000,1999]),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV3
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7512)
ID = 7512
scale = ifelse((root,Power=[2000,2999]),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV4
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7513)
ID = 7513
scale = ifelse((root,Power=[3000,3999]),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV5
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7514)
ID = 7514
scale = ifelse((root,Power=[4000,4999]),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

;ゲージLV5
[State 3802]
type = ModifyExplod
trigger1 = NumExplod(7515)
ID = 7515
scale = ifelse((root,Power>=5000),1,0),1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

[State 7500, RemoveExplod]
type = RemoveExplod
trigger1 = root,var(37) = 1
trigger3 = matchover = 1

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7501

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7502

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7510

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7511

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7512

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7513

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7514

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7515

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7520

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7521

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7522

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7523

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7524

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7525

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7526

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7900

[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7901


[state a]
type = removeexplod
trigger1 = RoundState > 2
trigger2 = matchover = 1
trigger3 = WinKo
IgnoreHitPause = 1
id = 7902
;-----------------------------------------------------------------------------
;======================================================
[Statedef 5900]
type = S

[State 5900, 1] ;Clear all int variables
type = VarRangeSet
trigger1 = roundsexisted = 0
value = 0

[State 5900, 2] ;Clear all float variables
type = VarRangeSet
trigger1 = roundsexisted = 0
fvalue = 0



[State 5900, 3] ;Intro for round 1
type = ChangeState
trigger1 = roundno = 1
value = 190

[state a]
type = varset
trigger1 = roundno = 1
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 2
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 3
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 4
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 5
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 6
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 7
v = 57
value = 900
[state a]
type = varset
trigger1 = roundno = 8
v = 57
value = 900
;_-------------------------------------------------
;====================================================
;=====================================================================
; Stuff to do
;=====================================================================

[Statedef -2]

;---------------------------------------------------------------------------------
;Comboed Number
;---------------------------------------------------------------------------------
[State -2, Comboed Number]
type= varadd
triggerall= RoundState=2
triggerall= EnemyNear,hitcount
trigger1= EnemyNear,Movetype=A 
trigger1= Time=0 && Movetype=H
var(6) = 1
ignorehitpause=1

[State -2, Comboed Number Reset]
type= varset
triggerall= var(6)
trigger1= Ctrl || MoveType != H
var(6) = 0
ignorehitpause=1


;---------------------------------------------------------------------------------
;ｱｻ0Fﾍｶｵﾄｾ狢・
;---------------------------------------------------------------------------------
[State -2, ]
type= varadd
triggerall= RoundState=2
trigger1= EnemyNear,HitDefAttr = SCA,NT
;trigger1 = (EnemyNear,Time=[0,1]) && Movetype=H
var(7) = P2BodyDist X
ignorehitpause=1




;---------------------------------------------------------------------------------
;ｻﾘﾆｴﾂ・
;---------------------------------------------------------------------------------
[State -2,]
type = Null;PowerAdd
trigger1 = RoundState = 2
value = GameTime%50 = 0
ignorehitpause = 1


[State -2,]
type = Null;LifeAdd
trigger1 = RoundState = 2
value = GameTime%40 = 0
ignorehitpause = 1


;---------------------------------------------------------------------------------
;Print
;---------------------------------------------------------------------------------
[State -3, Debug]
type = displaytoclipboard
Trigger1 = 1
text = "P2StateNo = %d p2HitTime = %d X = %d, Y = %d  var(11) = %d"
params = P2StateNo, EnemyNear,GetHitVar(hittime), P2BodyDist x,  P2BodyDist y, helper(33000),var(11)
ignorehitpause = 1

[State -3, Debug]
type = appendtoclipboard
Trigger1 = 1
text="\nTRACE %d, EnemyNear,pos x = %d EnemyNear,pos y = %d var(7)= %d EnemyNear,ctrl = %d EnemyNear,animtime = %d"  
params= var(50), EnemyNear,pos x, EnemyNear,pos y , var(7), EnemyNear,ctrl, EnemyNear,animtime
ignorehitpause = 1

;--------------------------------------
;ﾏﾔﾊｾﾑｪﾁｿ
[State -2,]
type = Explod
trigger1 = roundState = 2
anim = F310+life%10
pos = IfElse(TeamSide=1,122,204), 28
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1


[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F310+floor(life/10)%10
pos = IfElse(TeamSide=1,118,200), 28
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1


[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F310+floor(life/100)%10
pos = IfElse(TeamSide=1,114,196), 28
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1 


[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F310+floor(life/1000)%10
pos = IfElse(TeamSide=1,110,192), 28
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

;--------------------------------------

;--------------------------------------
;ﾆﾁｿ

[State -2,]
type = Explod
trigger1 = roundState = 2
anim = F300+Power%10
pos = IfElse(TeamSide=1,122,208), 4
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F300+floor(Power/10)%10
pos = IfElse(TeamSide=1,118,204), 4
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F300+floor(Power/100)%10
pos = IfElse(TeamSide=1,114,200), 4
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1 

[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F300+floor(Power/1000)%10
pos = IfElse(TeamSide=1,110,196), 4
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State -2,]
type =  Explod
trigger1 = roundState = 2
anim = F300+floor(Power/10000)%10
pos = IfElse(TeamSide=1,106,192), 4
postype = Left
bindtime = -1
ownpal = 1
ontop = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
;--------------------------------------

;===========================================================================
; Guard Crash Calculation
;===========================================================================
[State -2]
type = TargetState
TriggerAll = numtarget
TriggerAll = target,alive
TriggerAll = fvar(10) >= 10000
TriggerAll = target,StateType = S || target,StateType = C
TriggerAll = target,MoveType = H && target,StateNo = [120,159]
Trigger1 = MoveGuarded = 1
Trigger2 = ProjGuarded = 1
value = 5700

[State -2]
type = VarSet
TriggerAll = fvar(10) < 0
Trigger1 = 1
fvar(10) = 0
ignorehitpause = 1

[State -2]
type = VarAdd
TriggerAll = fvar(10) >= 1
Trigger1 = GameTime%37 = 0
fvar(10) = -100
ignorehitpause = 1

[State -2]
type = VarSet
TriggerAll = fvar(10) != 0
Trigger1 = roundstate != 2
Trigger2 = enemy,StateNo = 5700
fvar(10) = 0
ignorehitpause = 1

[State -2]
type = VarAdd
TriggerAll = RoundState = 2
TriggerAll = P2MoveType = H
TriggerAll = EnemyNear,time = 0
Trigger1 = moveguarded = 1
Trigger2 = ProjGuarded = 1
fvar(10) = ifelse(stateno < 1000, 500, 1200)
ignorehitpause = 1
persistent = 0

[State -2,]
type = Helper
triggerall = NumHelper(6510) = 0
trigger1 = p2stateno = 5700 && enemy,time = 1
trigger1 = p2movetype = H
name="crush"
id = 6510
pos = 0,0
postype = back
stateno = 6510
helpertype = normal
ownpal = 1
keyctrl = 0
size.xscale = 1
size.yscale = 1
supermovetime = 999
pausemovetime = 999

;===========================================================================
; FONDO 2K2 UM STATEDEF -2
;===========================================================================
[State 3520, 2002]
type = REMOVEExplod
trigger1 = STATENO= [5000,5999]
trigger2 = ANIM= [5000,5999]
trigger3 = STATENO= [5000,5999]
trigger3 = ANIM= [5000,5999]
id = 757575
ignorehitpause = 1

[State 3520, 2002]
type = REMOVEExplod
trigger1 = STATENO != 350099
id = 757575
ignorehitpause = 1


;======================================================

[state -2, ???]
type = Helper
trigger1 = numhelper(7500) = 0
id = 7500
name = "POWER BAR"
sprpriority = 1
pos = 0,0
postype = p1
stateno = 7500
helpertype = normal
pausemovetime = 99999999
supermovetime = 99999999
keyctrl = 0
ownpal = 1

; BARRAS DE LIFEBAR Y POWER BAR QUE INICIAN EL 1 ROUND
;===========================================================================

[State -2, VarSet]
type = VarSet
trigger1 = 1
var(37) = 0

[State -2, VarSet]
type = VarSet
trigger1 = RoundState = [0,1]
trigger2 = RoundState >= 3 && var(36) = 1
trigger3 = RoundState >= 3 && winko && alive = 1
var(37) = 1
IgnoreHitPause = 1


[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = var(37) = 1
flag = nobardisplay

[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = matchover
trigger1 = winko
flag = nomusic
IgnoreHitPause = 1


;===========================================================================
;===================================================================
; Max-On System
;===================================================================

[state -2 ,1]
type = varset
trigger1 = var(23) = 900
v = 21
value = power

[state a]
type = varadd
trigger1 = var(23) > 0
v = 23
value = -1

[state a]
type = varset
trigger1 = var(23) < 0
v = 23
value = 0

[state a]
type = powerset
trigger1 = var(23) > 0
trigger1 = stateno != [3000,3999]
value = var(21)
ignorehitpause = 1

[State a];1
type = palfx
trigger1 = var(23) > 0
trigger1 = gametime % 2 = 0
time = 1
add = 120,100,40
ignorehitpause = 1

[state a]; HELPER
type = Helper
trigger1 = numhelper(7750) = 0
id = 7750
name = "MAX"
sprpriority = 1
pos = 0,0
postype = p1
stateno = 7750
helpertype = normal
pausemovetime = 99999999
supermovetime = 99999999
keyctrl = 0
ownpal = 1

;================================================================================
; ------- No Air Guard --------
;===============================================================================
[State -2, AirGuard]
type = AssertSpecial
trigger1 = 1
flag = NoAirGuard
IgnoreHitPause = 1
;-------------------------------------------------------------------------------
;======================================================
;                       COUNTER
;======================================================
;-----------------------------------------------------------------------------
[State -2, Counter]
type = VarSet
trigger1 = P2MoveType = A
var(9) = 1

[State -2, Counter Time Add]
type = VarAdd
trigger1 = P2MoveType != A
trigger1 = var(9) >= 1
var(9) = 1

[State -2, Counter Time Reset]
type = VarSet
trigger1 = var(9) > 3
var(9) = 0
ignorehitpause = 1

[State -2, カウンターヒット呼出]
type = Helper
triggerall = Numhelper(6500) = 0
triggerall = var(9) >= 1
trigger1 = MoveHit = 1
trigger2 = ProjHit = 1
name = "counter"
id = 6500
pos = 0,0
postype = left
stateno = 6500
helpertype = normal
ownpal = 1
keyctrl = 0
size.xscale = 1
size.yscale = 1
persistent = 0
ignorehitpause = 1
supermovetime = 9999
pausemovetime = 9999

;-----------------------------------------------------------------------------
;---------------------------------------------------------------------
; Remove Special Effect when damaged
[State -2, 1]
type = AfterImageTime
trigger1 = MoveType = H
Time = 0

;---------------------------------------------------------------------
; ガードキャンセル緊急回避動作判定
[State -2,2]
type = VarSet
triggerall = Time = 0
trigger1 = StateNo = 150
trigger2 = StateNo = 152
trigger3 = StateNo = 154
v = 4
value = 1

[State -2,3]
type = VarSet
trigger1 = Var(4)  = 1
trigger1 = Time = 15
v = 4
value = 0

;---------------------------------------------------------------------
; Sound Fix
[State -2,4]
type = PlaySnd
triggerall = Time = 1
trigger1 = StateNo = 52
value = 47, 0

[State -2,PlaySnd]
type = PlaySnd
triggerall = Random < 333
triggerall = Time = 1
triggerall = StateNo = 5000 || StateNo = 5010
triggerall = Alive = 1
trigger1 = Anim = 5000
trigger2 = Anim = 5010
trigger3 = Anim = 5020
value = 5000, 0

[State -2,PlaySnd]
type = PlaySnd
triggerall = Random < 333
triggerall = Time = 1
triggerall = StateNo = 5000 || StateNo = 5010
triggerall = Alive = 1
trigger1 = Anim = 5001
trigger2 = Anim = 5011
trigger3 = Anim = 5021
value = 5000, 0

[State -2,PlaySnd]
type = PlaySnd
triggerall = Random < 333
triggerall = Time = 1
triggerall = StateNo = 5000 || StateNo = 5010
triggerall = Alive = 1
trigger1 = Anim = 5002
trigger2 = Anim = 5012
trigger3 = Anim = 5022
value = 5000, 1

[State -2,PlaySnd]
type = PlaySnd
triggerall = Random = [333, 666]
triggerall = Time = 1
triggerall = StateNo = 5000 || StateNo = 5010
triggerall = Alive = 1
trigger1 = Anim = 5002
trigger2 = Anim = 5012
trigger3 = Anim = 5022
value = 5000, 2

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = (StateNo = [200,210]) || (StateNo = [300,310])
trigger2 = (StateNo = [500,510]) || (StateNo = [700,760])
trigger3 = StateNo = 4500
value = 200, 0

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = (StateNo = [220,230]) || (StateNo = [320,330])
trigger2 = (StateNo = [520,530]) || (StateNo = [770,780])
value = 200, 1

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = StateNo = 610
value = 200, 2

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1 && Random < 400
trigger1 = StateNo = 200 || StateNo = 220 || StateNo = 300
trigger2 = StateNo = 320 || StateNo = 500 || StateNo = 520
value = 500, 0

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = StateNo = 210 || StateNo = 230 || StateNo = 310
trigger2 = StateNo = 330 || StateNo = 510 || StateNo = 530
value = 500, 1

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = StateNo = 700 || StateNo = 740
value = 500, 2

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1
trigger1 = StateNo = 730 || StateNo = 760 || StateNo = 780
value = 500, 3

[State -2,PlaySnd]
type = PlaySnd
triggerall = !MoveType = H && Time = 1 && Random < 600
trigger1 = (StateNo = [600,610]) || StateNo = 4500
value = 500, 4

;-----------------------------------------------------------


;-----------------------------------------------------------
; 大ジャンプ用フラグ
[State -2,14]
type = VarSet
trigger1 = Time = 0
trigger1 = Command = "holddown"
persistent = 0
v = 28
value = 1

[State -2,15]
type = VarSet
trigger1 = Time = 5
v = 28
value = 0

[State -2,16]
type = VarSet
triggerall = Var(26) != 0
trigger1 = StateType = A
trigger2 = MoveType = H
v = 26
value = 0

;---------------------------------------------------------------------
; 攻撃力補正・ヒットカウント数セット
[State -2,VarAdd]
type = VarAdd
trigger1 = HitPauseTime = 1
v = 3
value = 1
ignorehitpause = 1

[State -2,VarSet]
type = VarSet
triggerall = Var(3) != 0
trigger1 = !P2MoveType = H || (P2StateNo = [150,155]) || (P2StateNo = [5200,5201])
v = 3
value = 0
